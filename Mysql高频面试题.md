# Mysql高频面试题

## 索引是什么
索引是数据结构，是将无序的数据排列成有序的数据，方便我们快速查询数据。

## 聚簇索引和非聚簇索引
- 相同点：聚簇索引和非聚簇索引都是使用B+树实现
- 不同点：聚簇索引是将数据和索引列放到同一个文件，数据在B+树的叶子节点中存储，InnoDB的主键索引使用的就是聚簇索引。非聚簇索引则是分别存放，而B+树的叶子节点存放的只有索引列与数据地址，MyISAM主键索引以及InnoDB二级索引使用的就是非聚簇索引。
- 优劣势：聚簇索引不需要进行二次查询，因为数据有序，更适合范围查询和排序，但是聚簇索引如果主键是无序随机数据，如UUID，在插入数据时性能会比较低，如果单库推荐使用自增ID作为主键，分布式系统推荐使用雪花算法计算主键。

## mysql主从同步原理
mysql主从同步的过程： 
  
Mysql的主从复制中主要有三个线程：master(binlog dump thread)、salve(I/O thread、SQL thread)，master一条线程和salve两条线程。

* 主节点binlog，主从复制的基础是主库记录数据库的所有变更记录到binlog中，binlog是数据库服务器启动的那一刻起，保存所有修改数据库结构或内容的一个文件。
* 主节点log dump线程，当logbin有变动时，log dump线程读取其内容并发送给从节点。
* 从节点I/O线程接收binlog内容，并将其写入到 relay log文件中。
* 从节点的SQL线程读取relay log文件内容对数据更新进行重放，最终保证主从数据库的一致性。  

注意：数据同步是增量同步，而非全量同步。主从节点使用binlog文件+position偏移量来定位主从同步的位置，从节点会保证其已接收到偏移量，如果从节点发生宕机重启，则会自动从position的位置发起同步。  

由于mysql默认的复制方式是异步的，主库把日志发送从库后不关心从库是否处理完成，这样会产生一个问题，就是主库挂了，从库处理失败后，日志就丢失了。由此产生两个概念

##### 全同步复制
主库写入binlog后强制同步日志到从库，所有从库都执行完成后才返回给客户端，但是很显然这个方式性能会手影响。
##### 半同步复制
和全同步复制不同的是，半同步复制的逻辑是从库写入日志成功后返回ACK确认给主库，主库收到至少一个从库的确认就认为写操作完成。

## mysql中索引类型以及对性能的影响
* 普通索引：允许包含重复的值
* 唯一索引：可以保证数据记录的唯一性
* 主键：特殊的唯一索引，一张表中只能存在一个主键
* 联合索引：多个列联合建立的索引，会根据多个列进行排序，使用联合索引需符合最左前缀原则
* 全文索引：FULLTEXT  

影响：提高查询效率，占空间，降低插入、删除、更新表的速度。

## Explain使用
|列名|描述|
|-|-|
|id|s|
|select_type|s|
|table|s|
|partitions|s|
|type|s|
|possible_keys|s|
|key|s|
|key_len|s|
|ref|s|
|rows|s|
|filtered|s|
|extra|s|

## 